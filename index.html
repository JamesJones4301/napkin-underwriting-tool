
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Napkin Underwriting Tool</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-gray-100 to-indigo-200 min-h-screen">
  <div id="root" class="p-6"></div>
  <script>
    const { useState, createElement: e } = React;

    function App() {
      const [inputs, setInputs] = useState({
        units: 100,
        askingPrice: 8000000,
        offerPrice: 6000000,
        rent: 1200,
        expensesPerUnit: 6000,
        vacancy: 5,
        capRate: 7.5,
        rehabCosts: 500000,
        ltv: 75,
        interestRate: 6.5
      });

      const handleChange = (key, val) => {
        setInputs({ ...inputs, [key]: parseFloat(val) || 0 });
      };

      const annualIncome = inputs.units * inputs.rent * 12 * (1 - inputs.vacancy / 100);
      const annualExpenses = inputs.units * inputs.expensesPerUnit;
      const NOI = annualIncome - annualExpenses;
      const valuation = NOI / (inputs.capRate / 100);
      const totalCost = inputs.offerPrice + inputs.rehabCosts;
      const valuePremium = (valuation - totalCost) / totalCost * 100;
      const loanAmt = totalCost * (inputs.ltv / 100);
      const debtService = loanAmt * (inputs.interestRate / 100);
      const dscr = NOI / debtService;
      const cashFlow = NOI - debtService;
      const downPayment = totalCost - loanAmt;
      const coc = (cashFlow / downPayment) * 100;

      let dealStatus = "‚ö†Ô∏è Needs Review";
      if (valuePremium < 10 || dscr < 1.2 || coc < 8) {
        dealStatus = "‚ùå Bad Deal";
      } else if (valuePremium >= 25 && dscr >= 1.5 && coc >= 15) {
        dealStatus = "üí∞ Great Deal";
      } else if (valuePremium >= 15 && dscr >= 1.3 && coc >= 10) {
        dealStatus = "‚úÖ Good Deal";
      }

      const downloadJSON = () => {
        const data = {
          inputs, valuation, NOI, dscr, coc, valuePremium, dealStatus
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'deal_analysis.json';
        link.click();
        URL.revokeObjectURL(url);
      };

      const Input = (label, key, suffix = "") =>
        e("div", { className: "mb-4" },
          e("label", { className: "block text-gray-700 font-semibold mb-1" }, label),
          e("input", {
            type: "number",
            value: inputs[key],
            onChange: e => handleChange(key, e.target.value),
            className: "w-full p-2 border border-gray-300 rounded"
          }),
          suffix && e("span", { className: "text-sm text-gray-600 ml-1" }, suffix)
        );

      const Metric = (label, value) =>
        e("div", { className: "flex justify-between mb-2" },
          e("span", { className: "text-gray-600" }, label),
          e("span", { className: "font-medium" }, value)
        );

      return e("div", { className: "max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-8" },
        e("h1", { className: "text-3xl font-bold text-indigo-600 mb-6" }, "üìä Napkin Underwriting Tool"),
        e("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6 mb-6" }, [
          Input("Units", "units"),
          Input("Asking Price ($)", "askingPrice"),
          Input("Offer Price ($)", "offerPrice"),
          Input("Monthly Rent/Unit ($)", "rent"),
          Input("Expenses/Unit/Year ($)", "expensesPerUnit"),
          Input("Vacancy Rate (%)", "vacancy"),
          Input("Cap Rate (%)", "capRate"),
          Input("Rehab Costs ($)", "rehabCosts"),
          Input("LTV (%)", "ltv"),
          Input("Interest Rate (%)", "interestRate"),
        ]),
        e("h2", { className: "text-xl font-bold text-indigo-700 mb-2" }, "üìà Deal Metrics"),
        Metric("Annual Income", "$" + annualIncome.toFixed(0)),
        Metric("Annual Expenses", "$" + annualExpenses.toFixed(0)),
        Metric("Net Operating Income (NOI)", "$" + NOI.toFixed(0)),
        Metric("Valuation @ Cap Rate", "$" + valuation.toFixed(0)),
        Metric("Value Premium over Cost", valuePremium.toFixed(1) + "%"),
        Metric("DSCR", dscr.toFixed(2)),
        Metric("Cash-on-Cash Return", coc.toFixed(1) + "%"),
        Metric("Status", dealStatus),
        e("div", { className: "mt-6 flex gap-4" },
          e("button", {
            onClick: downloadJSON,
            className: "px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
          }, "üìÅ Export Deal JSON")
        )
      );
    }

    ReactDOM.render(React.createElement(App), document.getElementById("root"));
  </script>
</body>
</html>
